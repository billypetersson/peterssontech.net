<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines"><meta name=keywords content="Python,Automation,DevOps,Scripting,Workflows"><meta name=author content="Billy Petersson"><meta property="og:type" content="website"><meta property="og:url" content="https://peterssontech.net/blog/python-automation-guide/"><meta property="og:title" content="Python Automation: From Repetitive Tasks to Production Workflows | Billy Petersson - IT Professional Portfolio"><meta property="og:description" content="Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://peterssontech.net/blog/python-automation-guide/"><meta property="twitter:title" content="Python Automation: From Repetitive Tasks to Production Workflows | Billy Petersson - IT Professional Portfolio"><meta property="twitter:description" content="Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines"><title>Python Automation: From Repetitive Tasks to Production Workflows | Billy Petersson - IT Professional Portfolio</title>
<meta name=description content="Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines"><meta name=keywords content="Python,Automation,DevOps,Scripting,Workflows"><meta name=author content="Billy Petersson"><meta name=robots content="index, follow"><meta name=language content="en-us"><link rel=canonical href=https://peterssontech.net/blog/python-automation-guide/><meta property="og:type" content="article"><meta property="og:url" content="https://peterssontech.net/blog/python-automation-guide/"><meta property="og:title" content="Python Automation: From Repetitive Tasks to Production Workflows | Billy Petersson - IT Professional Portfolio"><meta property="og:description" content="Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines"><meta property="og:site_name" content="Billy Petersson - IT Professional Portfolio"><meta property="og:image" content="https://peterssontech.net/images/og-default.jpg"><meta property="og:locale" content="en-us"><meta property="article:author" content="Billy Petersson"><meta property="article:published_time" content="2024-11-25T00:00:00Z"><meta property="article:modified_time" content="2024-11-25T00:00:00Z"><meta property="article:tag" content="Python"><meta property="article:tag" content="Automation"><meta property="article:tag" content="DevOps"><meta property="article:tag" content="Scripting"><meta property="article:tag" content="Workflows"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://peterssontech.net/blog/python-automation-guide/"><meta name=twitter:title content="Python Automation: From Repetitive Tasks to Production Workflows | Billy Petersson - IT Professional Portfolio"><meta name=twitter:description content="Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines"><meta name=twitter:image content="https://peterssontech.net/images/og-default.jpg"><meta name=twitter:creator content="@billy_petersson"><meta name=twitter:site content="@billy_petersson"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","name":"Python Automation: From Repetitive Tasks to Production Workflows","headline":"Python Automation: From Repetitive Tasks to Production Workflows","description":"Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines","url":"https:\/\/peterssontech.net\/blog\/python-automation-guide\/","author":{"@type":"Person","name":"Billy Petersson","url":"https:\/\/peterssontech.net\//about/","sameAs":["https:\/\/linkedin.com\/in\/billy-petersson","https:\/\/github.com\/billy-petersson"]},"datePublished":"2024-11-25T00:00:00Z","dateModified":"2024-11-25T00:00:00Z","publisher":{"@type":"Person","name":"Billy Petersson","url":"https:\/\/peterssontech.net\/"},"mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/peterssontech.net\/blog\/python-automation-guide\/"}}</script><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=dns-prefetch href=//cdnjs.cloudflare.com><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=icon type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=stylesheet href=/css/main.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css></head><body><a href=#main class=skip-link>Skip to main content</a><header class=header role=banner><nav class=navbar role=navigation aria-label="Main navigation"><div class=container><div class=nav-brand><a href=/ class=brand-link aria-label="Billy Petersson - Home"><span class=brand-name>Billy Petersson</span>
<span class=brand-title>IT Professional</span></a></div><button class=nav-toggle id=navToggle aria-label="Toggle navigation menu" aria-expanded=false aria-controls=navMenu>
<span></span>
<span></span>
<span></span></button><ul class=nav-menu id=navMenu role=menubar><li class=nav-item role=none><a href=/ class=nav-link role=menuitem>Home</a></li><li class=nav-item role=none><a href=/about/ class=nav-link role=menuitem>About</a></li><li class=nav-item role=none><a href=/skills/ class=nav-link role=menuitem>Skills</a></li><li class=nav-item role=none><a href=/experience/ class=nav-link role=menuitem>Experience</a></li><li class=nav-item role=none><a href=/projects/ class=nav-link role=menuitem>Projects</a></li><li class=nav-item role=none><a href=/blog/ class=nav-link role=menuitem>Blog</a></li><li class=nav-item role=none><a href=/contact/ class=nav-link role=menuitem>Contact</a></li></ul></div></nav></header><main id=main role=main><div class=section style=padding-top:3rem><div class=container><nav aria-label=Breadcrumb class=breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=/ aria-label=Home><i class="fas fa-home" aria-hidden=true></i>
<span class=sr-only>Home</span></a></li><li class=breadcrumb-item><a href=https://peterssontech.net/>Billy Petersson - IT Professional Portfolio</a></li><li class=breadcrumb-item><a href=https://peterssontech.net/blog/>Tech Blog</a></li><li class="breadcrumb-item active" aria-current=page>Python Automation: From Repetitive Tasks to Production Workflows</li></ol></nav><article class=single-content><header class=single-header><h1 class=single-title>Python Automation: From Repetitive Tasks to Production Workflows</h1><p class=single-description>Complete guide to Python automation covering file processing, API interactions, system administration, and building robust automation pipelines</p><div class=single-meta><span class=meta-item><i class="fas fa-calendar"></i>
<time datetime=2024-11-25>November 25, 2024</time>
</span><span class=meta-item><i class="fas fa-clock"></i>
12 min read
</span><span class=meta-item><i class="fas fa-user"></i>
Billy Petersson</span></div></header><div class=single-body><h1 id=python-automation-from-repetitive-tasks-to-production-workflows>Python Automation: From Repetitive Tasks to Production Workflows</h1><p>Python&rsquo;s simplicity and extensive library ecosystem make it an excellent choice for automation. This comprehensive guide will take you from basic task automation to building sophisticated production workflows.</p><h2 id=why-python-for-automation>Why Python for Automation?</h2><p>Python excels at automation because of:</p><ul><li><strong>Readable syntax</strong> that makes scripts easy to maintain</li><li><strong>Rich standard library</strong> covering most common tasks</li><li><strong>Extensive third-party packages</strong> for specialized operations</li><li><strong>Cross-platform compatibility</strong> for diverse environments</li><li><strong>Strong community support</strong> and documentation</li></ul><h2 id=1-file-and-directory-operations>1. File and Directory Operations</h2><h3 id=basic-file-processing>Basic File Processing</h3><p>Let&rsquo;s start with common file operations that form the foundation of many automation tasks:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> shutil
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> glob
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>organize_downloads_folder</span>():
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Organize files in downloads folder by extension.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    downloads_path <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span>home() <span style=color:#f92672>/</span> <span style=color:#e6db74>&#34;Downloads&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Define file type mappings</span>
</span></span><span style=display:flex><span>    file_types <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;images&#39;</span>: [<span style=color:#e6db74>&#39;.jpg&#39;</span>, <span style=color:#e6db74>&#39;.jpeg&#39;</span>, <span style=color:#e6db74>&#39;.png&#39;</span>, <span style=color:#e6db74>&#39;.gif&#39;</span>, <span style=color:#e6db74>&#39;.bmp&#39;</span>, <span style=color:#e6db74>&#39;.svg&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;documents&#39;</span>: [<span style=color:#e6db74>&#39;.pdf&#39;</span>, <span style=color:#e6db74>&#39;.doc&#39;</span>, <span style=color:#e6db74>&#39;.docx&#39;</span>, <span style=color:#e6db74>&#39;.txt&#39;</span>, <span style=color:#e6db74>&#39;.rtf&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;videos&#39;</span>: [<span style=color:#e6db74>&#39;.mp4&#39;</span>, <span style=color:#e6db74>&#39;.avi&#39;</span>, <span style=color:#e6db74>&#39;.mkv&#39;</span>, <span style=color:#e6db74>&#39;.mov&#39;</span>, <span style=color:#e6db74>&#39;.wmv&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;audio&#39;</span>: [<span style=color:#e6db74>&#39;.mp3&#39;</span>, <span style=color:#e6db74>&#39;.wav&#39;</span>, <span style=color:#e6db74>&#39;.flac&#39;</span>, <span style=color:#e6db74>&#39;.aac&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;archives&#39;</span>: [<span style=color:#e6db74>&#39;.zip&#39;</span>, <span style=color:#e6db74>&#39;.rar&#39;</span>, <span style=color:#e6db74>&#39;.tar&#39;</span>, <span style=color:#e6db74>&#39;.gz&#39;</span>, <span style=color:#e6db74>&#39;.7z&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;code&#39;</span>: [<span style=color:#e6db74>&#39;.py&#39;</span>, <span style=color:#e6db74>&#39;.js&#39;</span>, <span style=color:#e6db74>&#39;.html&#39;</span>, <span style=color:#e6db74>&#39;.css&#39;</span>, <span style=color:#e6db74>&#39;.java&#39;</span>, <span style=color:#e6db74>&#39;.cpp&#39;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create directories if they don&#39;t exist</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> folder <span style=color:#f92672>in</span> file_types<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>        folder_path <span style=color:#f92672>=</span> downloads_path <span style=color:#f92672>/</span> folder
</span></span><span style=display:flex><span>        folder_path<span style=color:#f92672>.</span>mkdir(exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Move files to appropriate folders</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> file_path <span style=color:#f92672>in</span> downloads_path<span style=color:#f92672>.</span>iterdir():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> file_path<span style=color:#f92672>.</span>is_file():
</span></span><span style=display:flex><span>            file_extension <span style=color:#f92672>=</span> file_path<span style=color:#f92672>.</span>suffix<span style=color:#f92672>.</span>lower()
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            moved <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> folder, extensions <span style=color:#f92672>in</span> file_types<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> file_extension <span style=color:#f92672>in</span> extensions:
</span></span><span style=display:flex><span>                    destination <span style=color:#f92672>=</span> downloads_path <span style=color:#f92672>/</span> folder <span style=color:#f92672>/</span> file_path<span style=color:#f92672>.</span>name
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    <span style=color:#75715e># Handle duplicate names</span>
</span></span><span style=display:flex><span>                    counter <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>while</span> destination<span style=color:#f92672>.</span>exists():
</span></span><span style=display:flex><span>                        name <span style=color:#f92672>=</span> file_path<span style=color:#f92672>.</span>stem
</span></span><span style=display:flex><span>                        extension <span style=color:#f92672>=</span> file_path<span style=color:#f92672>.</span>suffix
</span></span><span style=display:flex><span>                        destination <span style=color:#f92672>=</span> downloads_path <span style=color:#f92672>/</span> folder <span style=color:#f92672>/</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>counter<span style=color:#e6db74>}{</span>extension<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>                        counter <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    file_path<span style=color:#f92672>.</span>rename(destination)
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Moved </span><span style=color:#e6db74>{</span>file_path<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74> to </span><span style=color:#e6db74>{</span>folder<span style=color:#e6db74>}</span><span style=color:#e6db74>/&#34;</span>)
</span></span><span style=display:flex><span>                    moved <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> moved:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Unknown file type: </span><span style=color:#e6db74>{</span>file_path<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Advanced file processing with metadata</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>process_image_batch</span>():
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Batch process images with metadata extraction.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>from</span> PIL <span style=color:#f92672>import</span> Image, ExifTags
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    image_dir <span style=color:#f92672>=</span> Path(<span style=color:#e6db74>&#34;./images&#34;</span>)
</span></span><span style=display:flex><span>    processed_dir <span style=color:#f92672>=</span> Path(<span style=color:#e6db74>&#34;./processed_images&#34;</span>)
</span></span><span style=display:flex><span>    processed_dir<span style=color:#f92672>.</span>mkdir(exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    metadata_log <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> image_path <span style=color:#f92672>in</span> image_dir<span style=color:#f92672>.</span>glob(<span style=color:#e6db74>&#34;*.{jpg,jpeg,png}&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>with</span> Image<span style=color:#f92672>.</span>open(image_path) <span style=color:#66d9ef>as</span> img:
</span></span><span style=display:flex><span>                <span style=color:#75715e># Extract EXIF data</span>
</span></span><span style=display:flex><span>                exif_data <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> hasattr(img, <span style=color:#e6db74>&#39;_getexif&#39;</span>) <span style=color:#f92672>and</span> img<span style=color:#f92672>.</span>_getexif():
</span></span><span style=display:flex><span>                    exif <span style=color:#f92672>=</span> img<span style=color:#f92672>.</span>_getexif()
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> tag_id, value <span style=color:#f92672>in</span> exif<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>                        tag <span style=color:#f92672>=</span> ExifTags<span style=color:#f92672>.</span>TAGS<span style=color:#f92672>.</span>get(tag_id, tag_id)
</span></span><span style=display:flex><span>                        exif_data[tag] <span style=color:#f92672>=</span> value
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e># Resize image</span>
</span></span><span style=display:flex><span>                max_size <span style=color:#f92672>=</span> (<span style=color:#ae81ff>1920</span>, <span style=color:#ae81ff>1080</span>)
</span></span><span style=display:flex><span>                img<span style=color:#f92672>.</span>thumbnail(max_size, Image<span style=color:#f92672>.</span>Lanczos)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e># Save processed image</span>
</span></span><span style=display:flex><span>                output_path <span style=color:#f92672>=</span> processed_dir <span style=color:#f92672>/</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;processed_</span><span style=color:#e6db74>{</span>image_path<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>                img<span style=color:#f92672>.</span>save(output_path, optimize<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, quality<span style=color:#f92672>=</span><span style=color:#ae81ff>85</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e># Log metadata</span>
</span></span><span style=display:flex><span>                metadata_log<span style=color:#f92672>.</span>append({
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;original_file&#39;</span>: image_path<span style=color:#f92672>.</span>name,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;processed_file&#39;</span>: output_path<span style=color:#f92672>.</span>name,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;original_size&#39;</span>: image_path<span style=color:#f92672>.</span>stat()<span style=color:#f92672>.</span>st_size,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;processed_size&#39;</span>: output_path<span style=color:#f92672>.</span>stat()<span style=color:#f92672>.</span>st_size,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;dimensions&#39;</span>: img<span style=color:#f92672>.</span>size,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;timestamp&#39;</span>: datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>isoformat(),
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;camera_make&#39;</span>: exif_data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;Make&#39;</span>, <span style=color:#e6db74>&#39;Unknown&#39;</span>),
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;camera_model&#39;</span>: exif_data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;Model&#39;</span>, <span style=color:#e6db74>&#39;Unknown&#39;</span>)
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Processed </span><span style=color:#e6db74>{</span>image_path<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error processing </span><span style=color:#e6db74>{</span>image_path<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Save metadata log</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(processed_dir <span style=color:#f92672>/</span> <span style=color:#e6db74>&#34;processing_log.json&#34;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        json<span style=color:#f92672>.</span>dump(metadata_log, f, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    organize_downloads_folder()
</span></span><span style=display:flex><span>    process_image_batch()
</span></span></code></pre></div><h2 id=2-web-scraping-and-api-automation>2. Web Scraping and API Automation</h2><h3 id=advanced-web-scraping>Advanced Web Scraping</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bs4 <span style=color:#f92672>import</span> BeautifulSoup
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> logging
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dataclasses <span style=color:#f92672>import</span> dataclass
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> List, Optional
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> concurrent.futures
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> requests.adapters <span style=color:#f92672>import</span> HTTPAdapter
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> urllib3.util.retry <span style=color:#f92672>import</span> Retry
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@dataclass</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Product</span>:
</span></span><span style=display:flex><span>    name: str
</span></span><span style=display:flex><span>    price: float
</span></span><span style=display:flex><span>    rating: Optional[float]
</span></span><span style=display:flex><span>    reviews_count: int
</span></span><span style=display:flex><span>    availability: str
</span></span><span style=display:flex><span>    url: str
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EcommerceScraper</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, base_url: str, headers: dict <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>base_url <span style=color:#f92672>=</span> base_url
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>session <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>Session()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Configure retry strategy</span>
</span></span><span style=display:flex><span>        retry_strategy <span style=color:#f92672>=</span> Retry(
</span></span><span style=display:flex><span>            total<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>            backoff_factor<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            status_forcelist<span style=color:#f92672>=</span>[<span style=color:#ae81ff>429</span>, <span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>502</span>, <span style=color:#ae81ff>503</span>, <span style=color:#ae81ff>504</span>]
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        adapter <span style=color:#f92672>=</span> HTTPAdapter(max_retries<span style=color:#f92672>=</span>retry_strategy)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>mount(<span style=color:#e6db74>&#34;http://&#34;</span>, adapter)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>mount(<span style=color:#e6db74>&#34;https://&#34;</span>, adapter)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Set headers</span>
</span></span><span style=display:flex><span>        default_headers <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;User-Agent&#39;</span>: <span style=color:#e6db74>&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&#39;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>headers<span style=color:#f92672>.</span>update(headers <span style=color:#f92672>or</span> default_headers)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Setup logging</span>
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>basicConfig(level<span style=color:#f92672>=</span>logging<span style=color:#f92672>.</span>INFO)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger <span style=color:#f92672>=</span> logging<span style=color:#f92672>.</span>getLogger(__name__)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>scrape_product_page</span>(self, product_url: str) <span style=color:#f92672>-&gt;</span> Optional[Product]:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Scrape individual product page.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            response <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>get(product_url, timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>            response<span style=color:#f92672>.</span>raise_for_status()
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            soup <span style=color:#f92672>=</span> BeautifulSoup(response<span style=color:#f92672>.</span>content, <span style=color:#e6db74>&#39;html.parser&#39;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Extract product information (selectors depend on the website)</span>
</span></span><span style=display:flex><span>            name <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;h1&#39;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;product-title&#39;</span>)
</span></span><span style=display:flex><span>            price <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;span&#39;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;price&#39;</span>)
</span></span><span style=display:flex><span>            rating <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;div&#39;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rating&#39;</span>)
</span></span><span style=display:flex><span>            reviews <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;span&#39;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;reviews-count&#39;</span>)
</span></span><span style=display:flex><span>            availability <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;span&#39;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;availability&#39;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> all([name, price]):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Product(
</span></span><span style=display:flex><span>                name<span style=color:#f92672>=</span>name<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip(),
</span></span><span style=display:flex><span>                price<span style=color:#f92672>=</span>float(price<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;$&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;,&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)),
</span></span><span style=display:flex><span>                rating<span style=color:#f92672>=</span>float(rating<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;data-rating&#39;</span>, <span style=color:#ae81ff>0</span>)) <span style=color:#66d9ef>if</span> rating <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>                reviews_count<span style=color:#f92672>=</span>int(reviews<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>split()[<span style=color:#ae81ff>0</span>]) <span style=color:#66d9ef>if</span> reviews <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                availability<span style=color:#f92672>=</span>availability<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip() <span style=color:#66d9ef>if</span> availability <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#39;Unknown&#39;</span>,
</span></span><span style=display:flex><span>                url<span style=color:#f92672>=</span>product_url
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error scraping </span><span style=color:#e6db74>{</span>product_url<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>scrape_category</span>(self, category_url: str, max_pages: int <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>) <span style=color:#f92672>-&gt;</span> List[Product]:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Scrape all products from a category.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        products <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> page <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, max_pages <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                page_url <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>category_url<span style=color:#e6db74>}</span><span style=color:#e6db74>?page=</span><span style=color:#e6db74>{</span>page<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>                response <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>get(page_url, timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>                response<span style=color:#f92672>.</span>raise_for_status()
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                soup <span style=color:#f92672>=</span> BeautifulSoup(response<span style=color:#f92672>.</span>content, <span style=color:#e6db74>&#39;html.parser&#39;</span>)
</span></span><span style=display:flex><span>                product_links <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find_all(<span style=color:#e6db74>&#39;a&#39;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;product-link&#39;</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> product_links:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e># Use threading for concurrent scraping</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>with</span> concurrent<span style=color:#f92672>.</span>futures<span style=color:#f92672>.</span>ThreadPoolExecutor(max_workers<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>) <span style=color:#66d9ef>as</span> executor:
</span></span><span style=display:flex><span>                    futures <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> link <span style=color:#f92672>in</span> product_links:
</span></span><span style=display:flex><span>                        product_url <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>base_url <span style=color:#f92672>+</span> link<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;href&#39;</span>)
</span></span><span style=display:flex><span>                        futures<span style=color:#f92672>.</span>append(executor<span style=color:#f92672>.</span>submit(self<span style=color:#f92672>.</span>scrape_product_page, product_url))
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> future <span style=color:#f92672>in</span> concurrent<span style=color:#f92672>.</span>futures<span style=color:#f92672>.</span>as_completed(futures):
</span></span><span style=display:flex><span>                        product <span style=color:#f92672>=</span> future<span style=color:#f92672>.</span>result()
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> product:
</span></span><span style=display:flex><span>                            products<span style=color:#f92672>.</span>append(product)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Scraped page </span><span style=color:#e6db74>{</span>page<span style=color:#e6db74>}</span><span style=color:#e6db74>, found </span><span style=color:#e6db74>{</span>len(product_links)<span style=color:#e6db74>}</span><span style=color:#e6db74> products&#34;</span>)
</span></span><span style=display:flex><span>                time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)  <span style=color:#75715e># Be respectful to the server</span>
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error scraping page </span><span style=color:#e6db74>{</span>page<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> products
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>save_to_csv</span>(self, products: List[Product], filename: str):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Save products to CSV file.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame([product<span style=color:#f92672>.</span>__dict__ <span style=color:#66d9ef>for</span> product <span style=color:#f92672>in</span> products])
</span></span><span style=display:flex><span>        df<span style=color:#f92672>.</span>to_csv(filename, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Saved </span><span style=color:#e6db74>{</span>len(products)<span style=color:#e6db74>}</span><span style=color:#e6db74> products to </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># API Integration Example</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>APIAutomation</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, api_key: str, base_url: str):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>api_key <span style=color:#f92672>=</span> api_key
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>base_url <span style=color:#f92672>=</span> base_url
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>session <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>Session()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>headers<span style=color:#f92672>.</span>update({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;Authorization&#39;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Bearer </span><span style=color:#e6db74>{</span>api_key<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;Content-Type&#39;</span>: <span style=color:#e6db74>&#39;application/json&#39;</span>
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>bulk_user_operations</span>(self, users_csv: str):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Perform bulk operations on users from CSV.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(users_csv)
</span></span><span style=display:flex><span>        results <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> _, user_data <span style=color:#f92672>in</span> df<span style=color:#f92672>.</span>iterrows():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                <span style=color:#75715e># Create user</span>
</span></span><span style=display:flex><span>                user_payload <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;email&#39;</span>: user_data[<span style=color:#e6db74>&#39;email&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;name&#39;</span>: user_data[<span style=color:#e6db74>&#39;name&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;department&#39;</span>: user_data[<span style=color:#e6db74>&#39;department&#39;</span>]
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                response <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>post(
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>self<span style=color:#f92672>.</span>base_url<span style=color:#e6db74>}</span><span style=color:#e6db74>/users&#34;</span>,
</span></span><span style=display:flex><span>                    json<span style=color:#f92672>=</span>user_payload
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>201</span>:
</span></span><span style=display:flex><span>                    user_id <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()[<span style=color:#e6db74>&#39;id&#39;</span>]
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    <span style=color:#75715e># Assign role</span>
</span></span><span style=display:flex><span>                    role_payload <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;user_id&#39;</span>: user_id,
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;role&#39;</span>: user_data[<span style=color:#e6db74>&#39;role&#39;</span>]
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    role_response <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>post(
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>self<span style=color:#f92672>.</span>base_url<span style=color:#e6db74>}</span><span style=color:#e6db74>/roles/assign&#34;</span>,
</span></span><span style=display:flex><span>                        json<span style=color:#f92672>=</span>role_payload
</span></span><span style=display:flex><span>                    )
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    results<span style=color:#f92672>.</span>append({
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;email&#39;</span>: user_data[<span style=color:#e6db74>&#39;email&#39;</span>],
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;user_created&#39;</span>: <span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;role_assigned&#39;</span>: role_response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>200</span>,
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;user_id&#39;</span>: user_id
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    results<span style=color:#f92672>.</span>append({
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;email&#39;</span>: user_data[<span style=color:#e6db74>&#39;email&#39;</span>],
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;user_created&#39;</span>: <span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;error&#39;</span>: response<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.1</span>)  <span style=color:#75715e># Rate limiting</span>
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                results<span style=color:#f92672>.</span>append({
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;email&#39;</span>: user_data[<span style=color:#e6db74>&#39;email&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;user_created&#39;</span>: <span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;error&#39;</span>: str(e)
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Save results</span>
</span></span><span style=display:flex><span>        results_df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(results)
</span></span><span style=display:flex><span>        results_df<span style=color:#f92672>.</span>to_csv(<span style=color:#e6db74>&#39;user_creation_results.csv&#39;</span>, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> results
</span></span></code></pre></div><h2 id=3-system-administration-automation>3. System Administration Automation</h2><h3 id=server-monitoring-and-maintenance>Server Monitoring and Maintenance</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> psutil
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> subprocess
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> smtplib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> email.mime.text <span style=color:#f92672>import</span> MimeText
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> email.mime.multipart <span style=color:#f92672>import</span> MimeMultipart
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> schedule
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dataclasses <span style=color:#f92672>import</span> dataclass
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Dict, List
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@dataclass</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SystemMetrics</span>:
</span></span><span style=display:flex><span>    timestamp: str
</span></span><span style=display:flex><span>    cpu_percent: float
</span></span><span style=display:flex><span>    memory_percent: float
</span></span><span style=display:flex><span>    disk_usage: Dict[str, float]
</span></span><span style=display:flex><span>    network_io: Dict[str, int]
</span></span><span style=display:flex><span>    running_processes: int
</span></span><span style=display:flex><span>    load_average: List[float]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SystemMonitor</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, config_file: str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;monitor_config.json&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(config_file, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>config <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>thresholds <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;thresholds&#39;</span>]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>email_config <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;email&#39;</span>]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>metrics_history <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>collect_metrics</span>(self) <span style=color:#f92672>-&gt;</span> SystemMetrics:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Collect current system metrics.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># CPU usage</span>
</span></span><span style=display:flex><span>        cpu_percent <span style=color:#f92672>=</span> psutil<span style=color:#f92672>.</span>cpu_percent(interval<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Memory usage</span>
</span></span><span style=display:flex><span>        memory <span style=color:#f92672>=</span> psutil<span style=color:#f92672>.</span>virtual_memory()
</span></span><span style=display:flex><span>        memory_percent <span style=color:#f92672>=</span> memory<span style=color:#f92672>.</span>percent
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Disk usage for all mounted drives</span>
</span></span><span style=display:flex><span>        disk_usage <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> partition <span style=color:#f92672>in</span> psutil<span style=color:#f92672>.</span>disk_partitions():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                usage <span style=color:#f92672>=</span> psutil<span style=color:#f92672>.</span>disk_usage(partition<span style=color:#f92672>.</span>mountpoint)
</span></span><span style=display:flex><span>                disk_usage[partition<span style=color:#f92672>.</span>mountpoint] <span style=color:#f92672>=</span> usage<span style=color:#f92672>.</span>percent
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>PermissionError</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Network I/O</span>
</span></span><span style=display:flex><span>        network <span style=color:#f92672>=</span> psutil<span style=color:#f92672>.</span>net_io_counters()
</span></span><span style=display:flex><span>        network_io <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;bytes_sent&#39;</span>: network<span style=color:#f92672>.</span>bytes_sent,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;bytes_recv&#39;</span>: network<span style=color:#f92672>.</span>bytes_recv
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Running processes</span>
</span></span><span style=display:flex><span>        running_processes <span style=color:#f92672>=</span> len(psutil<span style=color:#f92672>.</span>pids())
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Load average (Unix systems)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            load_average <span style=color:#f92672>=</span> list(psutil<span style=color:#f92672>.</span>getloadavg())
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>AttributeError</span>:
</span></span><span style=display:flex><span>            load_average <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> SystemMetrics(
</span></span><span style=display:flex><span>            timestamp<span style=color:#f92672>=</span>datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>isoformat(),
</span></span><span style=display:flex><span>            cpu_percent<span style=color:#f92672>=</span>cpu_percent,
</span></span><span style=display:flex><span>            memory_percent<span style=color:#f92672>=</span>memory_percent,
</span></span><span style=display:flex><span>            disk_usage<span style=color:#f92672>=</span>disk_usage,
</span></span><span style=display:flex><span>            network_io<span style=color:#f92672>=</span>network_io,
</span></span><span style=display:flex><span>            running_processes<span style=color:#f92672>=</span>running_processes,
</span></span><span style=display:flex><span>            load_average<span style=color:#f92672>=</span>load_average
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>check_thresholds</span>(self, metrics: SystemMetrics) <span style=color:#f92672>-&gt;</span> List[str]:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Check if any metrics exceed thresholds.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        alerts <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> metrics<span style=color:#f92672>.</span>cpu_percent <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>thresholds[<span style=color:#e6db74>&#39;cpu&#39;</span>]:
</span></span><span style=display:flex><span>            alerts<span style=color:#f92672>.</span>append(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;CPU usage: </span><span style=color:#e6db74>{</span>metrics<span style=color:#f92672>.</span>cpu_percent<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> metrics<span style=color:#f92672>.</span>memory_percent <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>thresholds[<span style=color:#e6db74>&#39;memory&#39;</span>]:
</span></span><span style=display:flex><span>            alerts<span style=color:#f92672>.</span>append(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Memory usage: </span><span style=color:#e6db74>{</span>metrics<span style=color:#f92672>.</span>memory_percent<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> mount, usage <span style=color:#f92672>in</span> metrics<span style=color:#f92672>.</span>disk_usage<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> usage <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>thresholds[<span style=color:#e6db74>&#39;disk&#39;</span>]:
</span></span><span style=display:flex><span>                alerts<span style=color:#f92672>.</span>append(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Disk usage </span><span style=color:#e6db74>{</span>mount<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>usage<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> metrics<span style=color:#f92672>.</span>load_average[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>thresholds[<span style=color:#e6db74>&#39;load&#39;</span>]:
</span></span><span style=display:flex><span>            alerts<span style=color:#f92672>.</span>append(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Load average: </span><span style=color:#e6db74>{</span>metrics<span style=color:#f92672>.</span>load_average[<span style=color:#ae81ff>0</span>]<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> alerts
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>send_alert_email</span>(self, alerts: List[str], metrics: SystemMetrics):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Send alert email when thresholds are exceeded.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        msg <span style=color:#f92672>=</span> MimeMultipart()
</span></span><span style=display:flex><span>        msg[<span style=color:#e6db74>&#39;From&#39;</span>] <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>email_config[<span style=color:#e6db74>&#39;from&#39;</span>]
</span></span><span style=display:flex><span>        msg[<span style=color:#e6db74>&#39;To&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;, &#39;</span><span style=color:#f92672>.</span>join(self<span style=color:#f92672>.</span>email_config[<span style=color:#e6db74>&#39;to&#39;</span>])
</span></span><span style=display:flex><span>        msg[<span style=color:#e6db74>&#39;Subject&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;System Alert - </span><span style=color:#e6db74>{</span>datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74> %H:%M&#39;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        body <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        System Alert Triggered!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Timestamp: </span><span style=color:#e6db74>{</span>metrics<span style=color:#f92672>.</span>timestamp<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Threshold Violations:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        </span><span style=color:#e6db74>{</span>chr(<span style=color:#ae81ff>10</span>)<span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>+</span> alert <span style=color:#66d9ef>for</span> alert <span style=color:#f92672>in</span> alerts)<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Current System Status:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>         CPU Usage: </span><span style=color:#e6db74>{</span>metrics<span style=color:#f92672>.</span>cpu_percent<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%
</span></span></span><span style=display:flex><span><span style=color:#e6db74>         Memory Usage: </span><span style=color:#e6db74>{</span>metrics<span style=color:#f92672>.</span>memory_percent<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%
</span></span></span><span style=display:flex><span><span style=color:#e6db74>         Running Processes: </span><span style=color:#e6db74>{</span>metrics<span style=color:#f92672>.</span>running_processes<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>         Load Average: </span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;, &#39;</span><span style=color:#f92672>.</span>join(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>load<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span> <span style=color:#66d9ef>for</span> load <span style=color:#f92672>in</span> metrics<span style=color:#f92672>.</span>load_average)<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Disk Usage:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        </span><span style=color:#e6db74>{</span>chr(<span style=color:#ae81ff>10</span>)<span style=color:#f92672>.</span>join(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39; </span><span style=color:#e6db74>{</span>mount<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>usage<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%&#39;</span> <span style=color:#66d9ef>for</span> mount, usage <span style=color:#f92672>in</span> metrics<span style=color:#f92672>.</span>disk_usage<span style=color:#f92672>.</span>items())<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        msg<span style=color:#f92672>.</span>attach(MimeText(body, <span style=color:#e6db74>&#39;plain&#39;</span>))
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            server <span style=color:#f92672>=</span> smtplib<span style=color:#f92672>.</span>SMTP(self<span style=color:#f92672>.</span>email_config[<span style=color:#e6db74>&#39;smtp_server&#39;</span>], self<span style=color:#f92672>.</span>email_config[<span style=color:#e6db74>&#39;smtp_port&#39;</span>])
</span></span><span style=display:flex><span>            server<span style=color:#f92672>.</span>starttls()
</span></span><span style=display:flex><span>            server<span style=color:#f92672>.</span>login(self<span style=color:#f92672>.</span>email_config[<span style=color:#e6db74>&#39;username&#39;</span>], self<span style=color:#f92672>.</span>email_config[<span style=color:#e6db74>&#39;password&#39;</span>])
</span></span><span style=display:flex><span>            server<span style=color:#f92672>.</span>send_message(msg)
</span></span><span style=display:flex><span>            server<span style=color:#f92672>.</span>quit()
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Alert email sent successfully&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to send alert email: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>cleanup_logs</span>(self, log_dir: str, retention_days: int <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Clean up old log files.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        log_path <span style=color:#f92672>=</span> Path(log_dir)
</span></span><span style=display:flex><span>        cutoff_date <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now() <span style=color:#f92672>-</span> datetime<span style=color:#f92672>.</span>timedelta(days<span style=color:#f92672>=</span>retention_days)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        cleaned_files <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> log_file <span style=color:#f92672>in</span> log_path<span style=color:#f92672>.</span>glob(<span style=color:#e6db74>&#39;*.log&#39;</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>fromtimestamp(log_file<span style=color:#f92672>.</span>stat()<span style=color:#f92672>.</span>st_mtime) <span style=color:#f92672>&lt;</span> cutoff_date:
</span></span><span style=display:flex><span>                log_file<span style=color:#f92672>.</span>unlink()
</span></span><span style=display:flex><span>                cleaned_files<span style=color:#f92672>.</span>append(log_file<span style=color:#f92672>.</span>name)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> cleaned_files:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Cleaned up </span><span style=color:#e6db74>{</span>len(cleaned_files)<span style=color:#e6db74>}</span><span style=color:#e6db74> old log files&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> cleaned_files
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>backup_databases</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Backup databases using configured commands.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        backup_dir <span style=color:#f92672>=</span> Path(self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;backup&#39;</span>][<span style=color:#e6db74>&#39;directory&#39;</span>])
</span></span><span style=display:flex><span>        backup_dir<span style=color:#f92672>.</span>mkdir(exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        timestamp <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y%m</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>_%H%M%S&#39;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> db_config <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;backup&#39;</span>][<span style=color:#e6db74>&#39;databases&#39;</span>]:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                backup_file <span style=color:#f92672>=</span> backup_dir <span style=color:#f92672>/</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;name&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>timestamp<span style=color:#e6db74>}</span><span style=color:#e6db74>.sql&#34;</span>
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                cmd <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;mysqldump&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;-h&#39;</span>, db_config[<span style=color:#e6db74>&#39;host&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;-u&#39;</span>, db_config[<span style=color:#e6db74>&#39;user&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;-p</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;password&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>                    db_config[<span style=color:#e6db74>&#39;database&#39;</span>]
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>with</span> open(backup_file, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>                    subprocess<span style=color:#f92672>.</span>run(cmd, stdout<span style=color:#f92672>=</span>f, check<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e># Compress backup</span>
</span></span><span style=display:flex><span>                subprocess<span style=color:#f92672>.</span>run([<span style=color:#e6db74>&#39;gzip&#39;</span>, str(backup_file)], check<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Database backup completed: </span><span style=color:#e6db74>{</span>backup_file<span style=color:#e6db74>}</span><span style=color:#e6db74>.gz&#34;</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> subprocess<span style=color:#f92672>.</span>CalledProcessError <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Database backup failed for </span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;name&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_monitoring_cycle</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Run a complete monitoring cycle.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Running monitoring cycle at </span><span style=color:#e6db74>{</span>datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Collect metrics</span>
</span></span><span style=display:flex><span>        metrics <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>collect_metrics()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>metrics_history<span style=color:#f92672>.</span>append(metrics)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Keep only last 24 hours of metrics</span>
</span></span><span style=display:flex><span>        cutoff_time <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now() <span style=color:#f92672>-</span> datetime<span style=color:#f92672>.</span>timedelta(hours<span style=color:#f92672>=</span><span style=color:#ae81ff>24</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>metrics_history <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            m <span style=color:#66d9ef>for</span> m <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>metrics_history 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>fromisoformat(m<span style=color:#f92672>.</span>timestamp) <span style=color:#f92672>&gt;</span> cutoff_time
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Check thresholds</span>
</span></span><span style=display:flex><span>        alerts <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>check_thresholds(metrics)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> alerts:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>send_alert_email(alerts, metrics)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Save metrics to file</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;system_metrics.json&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>            json<span style=color:#f92672>.</span>dump([m<span style=color:#f92672>.</span>__dict__ <span style=color:#66d9ef>for</span> m <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>metrics_history], f, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Monitoring cycle completed. Alerts: </span><span style=color:#e6db74>{</span>len(alerts)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Configuration file example (monitor_config.json)</span>
</span></span><span style=display:flex><span>config_example <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;thresholds&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;cpu&#34;</span>: <span style=color:#ae81ff>80</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;memory&#34;</span>: <span style=color:#ae81ff>85</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;disk&#34;</span>: <span style=color:#ae81ff>90</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;load&#34;</span>: <span style=color:#ae81ff>2.0</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;email&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;smtp_server&#34;</span>: <span style=color:#e6db74>&#34;smtp.gmail.com&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;smtp_port&#34;</span>: <span style=color:#ae81ff>587</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;username&#34;</span>: <span style=color:#e6db74>&#34;your_email@gmail.com&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;your_app_password&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;from&#34;</span>: <span style=color:#e6db74>&#34;monitor@yourserver.com&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;to&#34;</span>: [<span style=color:#e6db74>&#34;admin@yourcompany.com&#34;</span>]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;backup&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;directory&#34;</span>: <span style=color:#e6db74>&#34;/backups&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;databases&#34;</span>: [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;production_db&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;host&#34;</span>: <span style=color:#e6db74>&#34;localhost&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;user&#34;</span>: <span style=color:#e6db74>&#34;backup_user&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;backup_password&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;database&#34;</span>: <span style=color:#e6db74>&#34;production&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=4-data-processing-automation>4. Data Processing Automation</h2><h3 id=etl-pipeline-implementation>ETL Pipeline Implementation</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sqlite3
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sqlalchemy <span style=color:#f92672>import</span> create_engine
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> logging
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Dict, List, Any
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dataclasses <span style=color:#f92672>import</span> dataclass
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> boto3
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime, timedelta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@dataclass</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DataSource</span>:
</span></span><span style=display:flex><span>    name: str
</span></span><span style=display:flex><span>    type: str  <span style=color:#75715e># &#39;api&#39;, &#39;csv&#39;, &#39;database&#39;, &#39;s3&#39;</span>
</span></span><span style=display:flex><span>    connection_params: Dict[str, Any]
</span></span><span style=display:flex><span>    query: str <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ETLPipeline</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, config_file: str):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(config_file, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>config <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>setup_logging()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>setup_connections()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setup_logging</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Setup logging configuration.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>basicConfig(
</span></span><span style=display:flex><span>            level<span style=color:#f92672>=</span>logging<span style=color:#f92672>.</span>INFO,
</span></span><span style=display:flex><span>            format<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>%(asctime)s</span><span style=color:#e6db74> - </span><span style=color:#e6db74>%(name)s</span><span style=color:#e6db74> - </span><span style=color:#e6db74>%(levelname)s</span><span style=color:#e6db74> - </span><span style=color:#e6db74>%(message)s</span><span style=color:#e6db74>&#39;</span>,
</span></span><span style=display:flex><span>            handlers<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>                logging<span style=color:#f92672>.</span>FileHandler(<span style=color:#e6db74>&#39;etl_pipeline.log&#39;</span>),
</span></span><span style=display:flex><span>                logging<span style=color:#f92672>.</span>StreamHandler()
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger <span style=color:#f92672>=</span> logging<span style=color:#f92672>.</span>getLogger(__name__)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setup_connections</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Setup database and other service connections.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>engines <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> db_name, db_config <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;databases&#39;</span>]<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>            connection_string <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>                <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;type&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>://</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;user&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>:&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;password&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>@</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;host&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>:&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;port&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>db_config[<span style=color:#e6db74>&#39;database&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>engines[db_name] <span style=color:#f92672>=</span> create_engine(connection_string)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Setup AWS S3 client if configured</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;aws&#39;</span> <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>config:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>s3_client <span style=color:#f92672>=</span> boto3<span style=color:#f92672>.</span>client(
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;s3&#39;</span>,
</span></span><span style=display:flex><span>                aws_access_key_id<span style=color:#f92672>=</span>self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;aws&#39;</span>][<span style=color:#e6db74>&#39;access_key&#39;</span>],
</span></span><span style=display:flex><span>                aws_secret_access_key<span style=color:#f92672>=</span>self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;aws&#39;</span>][<span style=color:#e6db74>&#39;secret_key&#39;</span>],
</span></span><span style=display:flex><span>                region_name<span style=color:#f92672>=</span>self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;aws&#39;</span>][<span style=color:#e6db74>&#39;region&#39;</span>]
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_from_api</span>(self, source: DataSource) <span style=color:#f92672>-&gt;</span> pd<span style=color:#f92672>.</span>DataFrame:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Extract data from API source.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            headers <span style=color:#f92672>=</span> source<span style=color:#f92672>.</span>connection_params<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;headers&#39;</span>, {})
</span></span><span style=display:flex><span>            params <span style=color:#f92672>=</span> source<span style=color:#f92672>.</span>connection_params<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;params&#39;</span>, {})
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(
</span></span><span style=display:flex><span>                source<span style=color:#f92672>.</span>connection_params[<span style=color:#e6db74>&#39;url&#39;</span>],
</span></span><span style=display:flex><span>                headers<span style=color:#f92672>=</span>headers,
</span></span><span style=display:flex><span>                params<span style=color:#f92672>=</span>params,
</span></span><span style=display:flex><span>                timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            response<span style=color:#f92672>.</span>raise_for_status()
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            data <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Handle nested JSON structures</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;data_path&#39;</span> <span style=color:#f92672>in</span> source<span style=color:#f92672>.</span>connection_params:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> key <span style=color:#f92672>in</span> source<span style=color:#f92672>.</span>connection_params[<span style=color:#e6db74>&#39;data_path&#39;</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>):
</span></span><span style=display:flex><span>                    data <span style=color:#f92672>=</span> data[key]
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>json_normalize(data)
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Extracted </span><span style=color:#e6db74>{</span>len(df)<span style=color:#e6db74>}</span><span style=color:#e6db74> records from API: </span><span style=color:#e6db74>{</span>source<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> df
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to extract from API </span><span style=color:#e6db74>{</span>source<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> pd<span style=color:#f92672>.</span>DataFrame()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_from_database</span>(self, source: DataSource) <span style=color:#f92672>-&gt;</span> pd<span style=color:#f92672>.</span>DataFrame:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Extract data from database source.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            engine <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>engines[source<span style=color:#f92672>.</span>connection_params[<span style=color:#e6db74>&#39;engine_name&#39;</span>]]
</span></span><span style=display:flex><span>            df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_sql(source<span style=color:#f92672>.</span>query, engine)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Extracted </span><span style=color:#e6db74>{</span>len(df)<span style=color:#e6db74>}</span><span style=color:#e6db74> records from database: </span><span style=color:#e6db74>{</span>source<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> df
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to extract from database </span><span style=color:#e6db74>{</span>source<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> pd<span style=color:#f92672>.</span>DataFrame()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_from_csv</span>(self, source: DataSource) <span style=color:#f92672>-&gt;</span> pd<span style=color:#f92672>.</span>DataFrame:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Extract data from CSV file.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            file_path <span style=color:#f92672>=</span> source<span style=color:#f92672>.</span>connection_params[<span style=color:#e6db74>&#39;file_path&#39;</span>]
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Handle S3 CSV files</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> file_path<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;s3://&#39;</span>):
</span></span><span style=display:flex><span>                bucket, key <span style=color:#f92672>=</span> file_path[<span style=color:#ae81ff>5</span>:]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                obj <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>s3_client<span style=color:#f92672>.</span>get_object(Bucket<span style=color:#f92672>=</span>bucket, Key<span style=color:#f92672>=</span>key)
</span></span><span style=display:flex><span>                df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(obj[<span style=color:#e6db74>&#39;Body&#39;</span>])
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(file_path)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Extracted </span><span style=color:#e6db74>{</span>len(df)<span style=color:#e6db74>}</span><span style=color:#e6db74> records from CSV: </span><span style=color:#e6db74>{</span>source<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> df
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to extract from CSV </span><span style=color:#e6db74>{</span>source<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> pd<span style=color:#f92672>.</span>DataFrame()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>transform_data</span>(self, df: pd<span style=color:#f92672>.</span>DataFrame, transformations: List[Dict]) <span style=color:#f92672>-&gt;</span> pd<span style=color:#f92672>.</span>DataFrame:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Apply transformations to dataframe.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> transform <span style=color:#f92672>in</span> transformations:
</span></span><span style=display:flex><span>            transform_type <span style=color:#f92672>=</span> transform[<span style=color:#e6db74>&#39;type&#39;</span>]
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> transform_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;rename_columns&#39;</span>:
</span></span><span style=display:flex><span>                    df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>rename(columns<span style=color:#f92672>=</span>transform[<span style=color:#e6db74>&#39;mapping&#39;</span>])
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>elif</span> transform_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;filter_rows&#39;</span>:
</span></span><span style=display:flex><span>                    condition <span style=color:#f92672>=</span> transform[<span style=color:#e6db74>&#39;condition&#39;</span>]
</span></span><span style=display:flex><span>                    df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>query(condition)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>elif</span> transform_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;add_calculated_column&#39;</span>:
</span></span><span style=display:flex><span>                    df[transform[<span style=color:#e6db74>&#39;column_name&#39;</span>]] <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>eval(transform[<span style=color:#e6db74>&#39;expression&#39;</span>])
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>elif</span> transform_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;convert_types&#39;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> col, dtype <span style=color:#f92672>in</span> transform[<span style=color:#e6db74>&#39;columns&#39;</span>]<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> dtype <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;datetime&#39;</span>:
</span></span><span style=display:flex><span>                            df[col] <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(df[col])
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                            df[col] <span style=color:#f92672>=</span> df[col]<span style=color:#f92672>.</span>astype(dtype)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>elif</span> transform_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;fill_missing&#39;</span>:
</span></span><span style=display:flex><span>                    method <span style=color:#f92672>=</span> transform[<span style=color:#e6db74>&#39;method&#39;</span>]
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> method <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;forward_fill&#39;</span>:
</span></span><span style=display:flex><span>                        df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>fillna(method<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ffill&#39;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>elif</span> method <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;backward_fill&#39;</span>:
</span></span><span style=display:flex><span>                        df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>fillna(method<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;bfill&#39;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>elif</span> method <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;value&#39;</span>:
</span></span><span style=display:flex><span>                        df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>fillna(transform[<span style=color:#e6db74>&#39;value&#39;</span>])
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>elif</span> transform_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;aggregate&#39;</span>:
</span></span><span style=display:flex><span>                    group_by <span style=color:#f92672>=</span> transform[<span style=color:#e6db74>&#39;group_by&#39;</span>]
</span></span><span style=display:flex><span>                    agg_funcs <span style=color:#f92672>=</span> transform[<span style=color:#e6db74>&#39;aggregations&#39;</span>]
</span></span><span style=display:flex><span>                    df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>groupby(group_by)<span style=color:#f92672>.</span>agg(agg_funcs)<span style=color:#f92672>.</span>reset_index()
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>elif</span> transform_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;join&#39;</span>:
</span></span><span style=display:flex><span>                    other_df <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>extract_data(transform[<span style=color:#e6db74>&#39;source&#39;</span>])
</span></span><span style=display:flex><span>                    df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>merge(
</span></span><span style=display:flex><span>                        other_df,
</span></span><span style=display:flex><span>                        on<span style=color:#f92672>=</span>transform[<span style=color:#e6db74>&#39;on&#39;</span>],
</span></span><span style=display:flex><span>                        how<span style=color:#f92672>=</span>transform<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;how&#39;</span>, <span style=color:#e6db74>&#39;inner&#39;</span>)
</span></span><span style=display:flex><span>                    )
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Applied transformation: </span><span style=color:#e6db74>{</span>transform_type<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to apply transformation </span><span style=color:#e6db74>{</span>transform_type<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> df
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_to_database</span>(self, df: pd<span style=color:#f92672>.</span>DataFrame, table_name: str, engine_name: str, if_exists: str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;replace&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Load dataframe to database table.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            engine <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>engines[engine_name]
</span></span><span style=display:flex><span>            df<span style=color:#f92672>.</span>to_sql(table_name, engine, if_exists<span style=color:#f92672>=</span>if_exists, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Loaded </span><span style=color:#e6db74>{</span>len(df)<span style=color:#e6db74>}</span><span style=color:#e6db74> records to table: </span><span style=color:#e6db74>{</span>table_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to load to database table </span><span style=color:#e6db74>{</span>table_name<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_to_csv</span>(self, df: pd<span style=color:#f92672>.</span>DataFrame, file_path: str):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Load dataframe to CSV file.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> file_path<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;s3://&#39;</span>):
</span></span><span style=display:flex><span>                <span style=color:#75715e># Upload to S3</span>
</span></span><span style=display:flex><span>                bucket, key <span style=color:#f92672>=</span> file_path[<span style=color:#ae81ff>5</span>:]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                csv_buffer <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>to_csv(index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>s3_client<span style=color:#f92672>.</span>put_object(
</span></span><span style=display:flex><span>                    Bucket<span style=color:#f92672>=</span>bucket,
</span></span><span style=display:flex><span>                    Key<span style=color:#f92672>=</span>key,
</span></span><span style=display:flex><span>                    Body<span style=color:#f92672>=</span>csv_buffer
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                df<span style=color:#f92672>.</span>to_csv(file_path, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Loaded </span><span style=color:#e6db74>{</span>len(df)<span style=color:#e6db74>}</span><span style=color:#e6db74> records to CSV: </span><span style=color:#e6db74>{</span>file_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Failed to load to CSV </span><span style=color:#e6db74>{</span>file_path<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_pipeline</span>(self, pipeline_name: str):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Run a complete ETL pipeline.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        pipeline_config <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;pipelines&#39;</span>][pipeline_name]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Starting ETL pipeline: </span><span style=color:#e6db74>{</span>pipeline_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Extract data from all sources</span>
</span></span><span style=display:flex><span>        dataframes <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> source_config <span style=color:#f92672>in</span> pipeline_config[<span style=color:#e6db74>&#39;sources&#39;</span>]:
</span></span><span style=display:flex><span>            source <span style=color:#f92672>=</span> DataSource(<span style=color:#f92672>**</span>source_config)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> source<span style=color:#f92672>.</span>type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;api&#39;</span>:
</span></span><span style=display:flex><span>                df <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>extract_from_api(source)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> source<span style=color:#f92672>.</span>type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;database&#39;</span>:
</span></span><span style=display:flex><span>                df <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>extract_from_database(source)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> source<span style=color:#f92672>.</span>type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;csv&#39;</span>:
</span></span><span style=display:flex><span>                df <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>extract_from_csv(source)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Unknown source type: </span><span style=color:#e6db74>{</span>source<span style=color:#f92672>.</span>type<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            dataframes[source<span style=color:#f92672>.</span>name] <span style=color:#f92672>=</span> df
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Transform data</span>
</span></span><span style=display:flex><span>        main_df <span style=color:#f92672>=</span> dataframes[pipeline_config[<span style=color:#e6db74>&#39;main_source&#39;</span>]]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;transformations&#39;</span> <span style=color:#f92672>in</span> pipeline_config:
</span></span><span style=display:flex><span>            main_df <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>transform_data(main_df, pipeline_config[<span style=color:#e6db74>&#39;transformations&#39;</span>])
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Load data to destinations</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> destination <span style=color:#f92672>in</span> pipeline_config[<span style=color:#e6db74>&#39;destinations&#39;</span>]:
</span></span><span style=display:flex><span>            dest_type <span style=color:#f92672>=</span> destination[<span style=color:#e6db74>&#39;type&#39;</span>]
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> dest_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;database&#39;</span>:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>load_to_database(
</span></span><span style=display:flex><span>                    main_df,
</span></span><span style=display:flex><span>                    destination[<span style=color:#e6db74>&#39;table_name&#39;</span>],
</span></span><span style=display:flex><span>                    destination[<span style=color:#e6db74>&#39;engine_name&#39;</span>],
</span></span><span style=display:flex><span>                    destination<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;if_exists&#39;</span>, <span style=color:#e6db74>&#39;replace&#39;</span>)
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> dest_type <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;csv&#39;</span>:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>load_to_csv(main_df, destination[<span style=color:#e6db74>&#39;file_path&#39;</span>])
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Completed ETL pipeline: </span><span style=color:#e6db74>{</span>pipeline_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> main_df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Usage example</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Setup monitoring</span>
</span></span><span style=display:flex><span>    monitor <span style=color:#f92672>=</span> SystemMonitor(<span style=color:#e6db74>&#39;monitor_config.json&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Schedule monitoring tasks</span>
</span></span><span style=display:flex><span>    schedule<span style=color:#f92672>.</span>every(<span style=color:#ae81ff>5</span>)<span style=color:#f92672>.</span>minutes<span style=color:#f92672>.</span>do(monitor<span style=color:#f92672>.</span>run_monitoring_cycle)
</span></span><span style=display:flex><span>    schedule<span style=color:#f92672>.</span>every()<span style=color:#f92672>.</span>day<span style=color:#f92672>.</span>at(<span style=color:#e6db74>&#34;02:00&#34;</span>)<span style=color:#f92672>.</span>do(monitor<span style=color:#f92672>.</span>backup_databases)
</span></span><span style=display:flex><span>    schedule<span style=color:#f92672>.</span>every()<span style=color:#f92672>.</span>day<span style=color:#f92672>.</span>at(<span style=color:#e6db74>&#34;03:00&#34;</span>)<span style=color:#f92672>.</span>do(<span style=color:#66d9ef>lambda</span>: monitor<span style=color:#f92672>.</span>cleanup_logs(<span style=color:#e6db74>&#39;/var/log&#39;</span>, <span style=color:#ae81ff>30</span>))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Run ETL pipeline</span>
</span></span><span style=display:flex><span>    etl <span style=color:#f92672>=</span> ETLPipeline(<span style=color:#e6db74>&#39;etl_config.json&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Schedule ETL jobs</span>
</span></span><span style=display:flex><span>    schedule<span style=color:#f92672>.</span>every()<span style=color:#f92672>.</span>hour<span style=color:#f92672>.</span>do(<span style=color:#66d9ef>lambda</span>: etl<span style=color:#f92672>.</span>run_pipeline(<span style=color:#e6db74>&#39;hourly_sales_data&#39;</span>))
</span></span><span style=display:flex><span>    schedule<span style=color:#f92672>.</span>every()<span style=color:#f92672>.</span>day<span style=color:#f92672>.</span>at(<span style=color:#e6db74>&#34;01:00&#34;</span>)<span style=color:#f92672>.</span>do(<span style=color:#66d9ef>lambda</span>: etl<span style=color:#f92672>.</span>run_pipeline(<span style=color:#e6db74>&#39;daily_user_analytics&#39;</span>))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Automation system started. Press Ctrl+C to stop.&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>            schedule<span style=color:#f92672>.</span>run_pending()
</span></span><span style=display:flex><span>            time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>60</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>KeyboardInterrupt</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Automation system stopped.&#34;</span>)
</span></span></code></pre></div><h2 id=5-production-ready-automation>5. Production-Ready Automation</h2><h3 id=error-handling-and-monitoring>Error Handling and Monitoring</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> functools
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> traceback
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Callable, Any
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> logging
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dataclasses <span style=color:#f92672>import</span> dataclass
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> enum <span style=color:#f92672>import</span> Enum
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TaskStatus</span>(Enum):
</span></span><span style=display:flex><span>    PENDING <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;pending&#34;</span>
</span></span><span style=display:flex><span>    RUNNING <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;running&#34;</span>
</span></span><span style=display:flex><span>    SUCCESS <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;success&#34;</span>
</span></span><span style=display:flex><span>    FAILED <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;failed&#34;</span>
</span></span><span style=display:flex><span>    RETRY <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;retry&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@dataclass</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TaskResult</span>:
</span></span><span style=display:flex><span>    task_name: str
</span></span><span style=display:flex><span>    status: TaskStatus
</span></span><span style=display:flex><span>    start_time: float
</span></span><span style=display:flex><span>    end_time: float <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>    error_message: str <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>    retry_count: int <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    result: Any <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>retry_on_failure</span>(max_retries: int <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>, delay: float <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>, backoff: float <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Decorator for automatic retry with exponential backoff.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decorator</span>(func: Callable) <span style=color:#f92672>-&gt;</span> Callable:
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>@functools.wraps</span>(func)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>wrapper</span>(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>            last_exception <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> attempt <span style=color:#f92672>in</span> range(max_retries <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> func(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                    last_exception <span style=color:#f92672>=</span> e
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> attempt <span style=color:#f92672>&lt;</span> max_retries:
</span></span><span style=display:flex><span>                        wait_time <span style=color:#f92672>=</span> delay <span style=color:#f92672>*</span> (backoff <span style=color:#f92672>**</span> attempt)
</span></span><span style=display:flex><span>                        logging<span style=color:#f92672>.</span>warning(
</span></span><span style=display:flex><span>                            <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Attempt </span><span style=color:#e6db74>{</span>attempt <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> failed for </span><span style=color:#e6db74>{</span>func<span style=color:#f92672>.</span>__name__<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>. &#34;</span>
</span></span><span style=display:flex><span>                            <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Retrying in </span><span style=color:#e6db74>{</span>wait_time<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> seconds...&#34;</span>
</span></span><span style=display:flex><span>                        )
</span></span><span style=display:flex><span>                        time<span style=color:#f92672>.</span>sleep(wait_time)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                        logging<span style=color:#f92672>.</span>error(
</span></span><span style=display:flex><span>                            <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;All </span><span style=color:#e6db74>{</span>max_retries <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> attempts failed for </span><span style=color:#e6db74>{</span>func<span style=color:#f92672>.</span>__name__<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>                        )
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> last_exception
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> wrapper
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> decorator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>monitor_task</span>(task_name: str):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Decorator for task monitoring and logging.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decorator</span>(func: Callable) <span style=color:#f92672>-&gt;</span> Callable:
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>@functools.wraps</span>(func)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>wrapper</span>(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>            task_result <span style=color:#f92672>=</span> TaskResult(
</span></span><span style=display:flex><span>                task_name<span style=color:#f92672>=</span>task_name,
</span></span><span style=display:flex><span>                status<span style=color:#f92672>=</span>TaskStatus<span style=color:#f92672>.</span>RUNNING,
</span></span><span style=display:flex><span>                start_time<span style=color:#f92672>=</span>time<span style=color:#f92672>.</span>time()
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            logger <span style=color:#f92672>=</span> logging<span style=color:#f92672>.</span>getLogger(__name__)
</span></span><span style=display:flex><span>            logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Starting task: </span><span style=color:#e6db74>{</span>task_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                result <span style=color:#f92672>=</span> func(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs)
</span></span><span style=display:flex><span>                task_result<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> TaskStatus<span style=color:#f92672>.</span>SUCCESS
</span></span><span style=display:flex><span>                task_result<span style=color:#f92672>.</span>result <span style=color:#f92672>=</span> result
</span></span><span style=display:flex><span>                task_result<span style=color:#f92672>.</span>end_time <span style=color:#f92672>=</span> time<span style=color:#f92672>.</span>time()
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                duration <span style=color:#f92672>=</span> task_result<span style=color:#f92672>.</span>end_time <span style=color:#f92672>-</span> task_result<span style=color:#f92672>.</span>start_time
</span></span><span style=display:flex><span>                logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Task completed successfully: </span><span style=color:#e6db74>{</span>task_name<span style=color:#e6db74>}</span><span style=color:#e6db74> (</span><span style=color:#e6db74>{</span>duration<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>s)&#34;</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                task_result<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> TaskStatus<span style=color:#f92672>.</span>FAILED
</span></span><span style=display:flex><span>                task_result<span style=color:#f92672>.</span>error_message <span style=color:#f92672>=</span> str(e)
</span></span><span style=display:flex><span>                task_result<span style=color:#f92672>.</span>end_time <span style=color:#f92672>=</span> time<span style=color:#f92672>.</span>time()
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                duration <span style=color:#f92672>=</span> task_result<span style=color:#f92672>.</span>end_time <span style=color:#f92672>-</span> task_result<span style=color:#f92672>.</span>start_time
</span></span><span style=display:flex><span>                logger<span style=color:#f92672>.</span>error(
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Task failed: </span><span style=color:#e6db74>{</span>task_name<span style=color:#e6db74>}</span><span style=color:#e6db74> (</span><span style=color:#e6db74>{</span>duration<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>s)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Traceback: </span><span style=color:#e6db74>{</span>traceback<span style=color:#f92672>.</span>format_exc()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>raise</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> wrapper
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> decorator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example usage of decorators</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@monitor_task</span>(<span style=color:#e6db74>&#34;data_backup&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>@retry_on_failure</span>(max_retries<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, delay<span style=color:#f92672>=</span><span style=color:#ae81ff>2.0</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>backup_critical_data</span>():
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Example task with monitoring and retry logic.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Simulate potential failure</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> random<span style=color:#f92672>.</span>random() <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.3</span>:  <span style=color:#75715e># 30% chance of failure</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;Simulated backup failure&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Backup completed successfully&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;backup_file_20241225.tar.gz&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Example usage</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> backup_critical_data()
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Backup result: </span><span style=color:#e6db74>{</span>result<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Backup ultimately failed: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=best-practices-for-production-automation>Best Practices for Production Automation</h2><h3 id=1-configuration-management>1. Configuration Management</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Use environment variables and config files</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Config</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, config_file: str <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>config_file <span style=color:#f92672>=</span> config_file <span style=color:#f92672>or</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#39;AUTOMATION_CONFIG&#39;</span>, <span style=color:#e6db74>&#39;config.json&#39;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>load_config()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_config</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Load configuration from file and environment variables.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> Path(self<span style=color:#f92672>.</span>config_file)<span style=color:#f92672>.</span>exists():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>with</span> open(self<span style=color:#f92672>.</span>config_file, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>config <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>config <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Override with environment variables</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>config<span style=color:#f92672>.</span>update({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;database_url&#39;</span>: os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#39;DATABASE_URL&#39;</span>, self<span style=color:#f92672>.</span>config<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;database_url&#39;</span>)),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;api_key&#39;</span>: os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#39;API_KEY&#39;</span>, self<span style=color:#f92672>.</span>config<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;api_key&#39;</span>)),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;log_level&#39;</span>: os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#39;LOG_LEVEL&#39;</span>, self<span style=color:#f92672>.</span>config<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;log_level&#39;</span>, <span style=color:#e6db74>&#39;INFO&#39;</span>))
</span></span><span style=display:flex><span>        })
</span></span></code></pre></div><h3 id=2-logging-and-monitoring>2. Logging and Monitoring</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> logging
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>StructuredLogger</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name: str):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger <span style=color:#f92672>=</span> logging<span style=color:#f92672>.</span>getLogger(name)
</span></span><span style=display:flex><span>        handler <span style=color:#f92672>=</span> logging<span style=color:#f92672>.</span>StreamHandler()
</span></span><span style=display:flex><span>        handler<span style=color:#f92672>.</span>setFormatter(logging<span style=color:#f92672>.</span>Formatter(<span style=color:#e6db74>&#39;</span><span style=color:#e6db74>%(message)s</span><span style=color:#e6db74>&#39;</span>))
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>addHandler(handler)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>logger<span style=color:#f92672>.</span>setLevel(logging<span style=color:#f92672>.</span>INFO)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>log_structured</span>(self, level: str, message: str, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Log structured data in JSON format.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        log_entry <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;timestamp&#39;</span>: datetime<span style=color:#f92672>.</span>utcnow()<span style=color:#f92672>.</span>isoformat(),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;level&#39;</span>: level,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;message&#39;</span>: message,
</span></span><span style=display:flex><span>            <span style=color:#f92672>**</span>kwargs
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        getattr(self<span style=color:#f92672>.</span>logger, level<span style=color:#f92672>.</span>lower())(json<span style=color:#f92672>.</span>dumps(log_entry))
</span></span></code></pre></div><h3 id=3-testing-automation-scripts>3. Testing Automation Scripts</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> unittest
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> unittest.mock <span style=color:#f92672>import</span> patch, MagicMock
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> tempfile
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TestAutomationScripts</span>(unittest<span style=color:#f92672>.</span>TestCase):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setUp</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>temp_dir <span style=color:#f92672>=</span> tempfile<span style=color:#f92672>.</span>mkdtemp()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>tearDown</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#f92672>import</span> shutil
</span></span><span style=display:flex><span>        shutil<span style=color:#f92672>.</span>rmtree(self<span style=color:#f92672>.</span>temp_dir)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@patch</span>(<span style=color:#e6db74>&#39;requests.get&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>test_api_extraction</span>(self, mock_get):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Test API data extraction.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Mock API response</span>
</span></span><span style=display:flex><span>        mock_response <span style=color:#f92672>=</span> MagicMock()
</span></span><span style=display:flex><span>        mock_response<span style=color:#f92672>.</span>json<span style=color:#f92672>.</span>return_value <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;data&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;test&#39;</span>}]}
</span></span><span style=display:flex><span>        mock_response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>        mock_get<span style=color:#f92672>.</span>return_value <span style=color:#f92672>=</span> mock_response
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Test extraction</span>
</span></span><span style=display:flex><span>        source <span style=color:#f92672>=</span> DataSource(
</span></span><span style=display:flex><span>            name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;test_api&#39;</span>,
</span></span><span style=display:flex><span>            type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;api&#39;</span>,
</span></span><span style=display:flex><span>            connection_params<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;url&#39;</span>: <span style=color:#e6db74>&#39;https://api.example.com/data&#39;</span>}
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        etl <span style=color:#f92672>=</span> ETLPipeline(<span style=color:#e6db74>&#39;test_config.json&#39;</span>)
</span></span><span style=display:flex><span>        df <span style=color:#f92672>=</span> etl<span style=color:#f92672>.</span>extract_from_api(source)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>assertEqual(len(df), <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>assertEqual(df<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;name&#39;</span>], <span style=color:#e6db74>&#39;test&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>test_file_organization</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Test file organization function.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Create test files</span>
</span></span><span style=display:flex><span>        test_files <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;test.jpg&#39;</span>, <span style=color:#e6db74>&#39;document.pdf&#39;</span>, <span style=color:#e6db74>&#39;video.mp4&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> filename <span style=color:#f92672>in</span> test_files:
</span></span><span style=display:flex><span>            (Path(self<span style=color:#f92672>.</span>temp_dir) <span style=color:#f92672>/</span> filename)<span style=color:#f92672>.</span>touch()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Test organization (would need to adapt organize_downloads_folder)</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># organize_files(self.temp_dir)</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Assert files are moved to correct directories</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>assertTrue((Path(self<span style=color:#f92672>.</span>temp_dir) <span style=color:#f92672>/</span> <span style=color:#e6db74>&#39;images&#39;</span> <span style=color:#f92672>/</span> <span style=color:#e6db74>&#39;test.jpg&#39;</span>)<span style=color:#f92672>.</span>exists())
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>assertTrue((Path(self<span style=color:#f92672>.</span>temp_dir) <span style=color:#f92672>/</span> <span style=color:#e6db74>&#39;documents&#39;</span> <span style=color:#f92672>/</span> <span style=color:#e6db74>&#39;document.pdf&#39;</span>)<span style=color:#f92672>.</span>exists())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    unittest<span style=color:#f92672>.</span>main()
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>Python automation can transform repetitive tasks into reliable, scalable processes. Key takeaways:</p><ol><li><strong>Start Simple</strong>: Begin with basic file operations and gradually add complexity</li><li><strong>Error Handling</strong>: Always implement proper error handling and retry logic</li><li><strong>Logging</strong>: Comprehensive logging is crucial for debugging and monitoring</li><li><strong>Configuration</strong>: Use external configuration files and environment variables</li><li><strong>Testing</strong>: Write tests for your automation scripts</li><li><strong>Monitoring</strong>: Implement monitoring and alerting for production systems</li></ol><p>Remember that good automation scripts are:</p><ul><li><strong>Reliable</strong>: Handle errors gracefully and recover when possible</li><li><strong>Maintainable</strong>: Well-documented and easy to modify</li><li><strong>Secure</strong>: Protect sensitive information and validate inputs</li><li><strong>Efficient</strong>: Optimize for performance and resource usage</li></ul><hr><p><em>What automation tasks are you working on? Share your experiences and challenges in the comments below!</em></p><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://docs.python.org/3/>Python Official Documentation</a></li><li><a href=https://pandas.pydata.org/docs/>Pandas Documentation</a></li><li><a href=https://requests.readthedocs.io/>Requests Library</a></li><li><a href=https://schedule.readthedocs.io/>Schedule Library</a></li></ul></div><footer class=single-footer><div class=tags><h4>Tags:</h4><a href=/tags/python/ class=tag>Python</a>
<a href=/tags/automation/ class=tag>Automation</a>
<a href=/tags/devops/ class=tag>DevOps</a>
<a href=/tags/scripting/ class=tag>Scripting</a>
<a href=/tags/workflows/ class=tag>Workflows</a></div></footer></article></div></div><style>.single-content{max-width:800px;margin:0 auto}.single-header{text-align:center;margin-bottom:3rem;padding-bottom:2rem;border-bottom:1px solid var(--border-color)}.single-title{font-size:3rem;font-weight:700;color:var(--text-primary);margin-bottom:1rem;line-height:1.2}.single-description{font-size:1.25rem;color:var(--text-secondary);margin-bottom:2rem;line-height:1.6}.single-meta{display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;color:var(--text-secondary);font-size:.9rem}.meta-item{display:flex;align-items:center;gap:.5rem}.single-body{line-height:1.8;color:var(--text-primary)}.single-body h1,.single-body h2,.single-body h3,.single-body h4,.single-body h5,.single-body h6{color:var(--text-primary);margin-top:2rem;margin-bottom:1rem;font-weight:600}.single-body h1{font-size:2.5rem;border-bottom:2px solid var(--primary-color);padding-bottom:.5rem}.single-body h2{font-size:2rem;color:var(--primary-color)}.single-body h3{font-size:1.5rem}.single-body h4{font-size:1.25rem}.single-body p{margin-bottom:1.5rem}.single-body ul,.single-body ol{margin-bottom:1.5rem;padding-left:2rem}.single-body li{margin-bottom:.5rem}.single-body blockquote{border-left:4px solid var(--primary-color);padding-left:1.5rem;margin:2rem 0;font-style:italic;color:var(--text-secondary)}.single-body code{background-color:var(--bg-secondary);padding:.2rem .4rem;border-radius:.25rem;font-family:courier new,monospace;font-size:.9rem}.single-body pre{background-color:var(--bg-secondary);padding:1.5rem;border-radius:.5rem;overflow-x:auto;margin:2rem 0}.single-body pre code{background-color:transparent;padding:0}.single-body table{width:100%;border-collapse:collapse;margin:2rem 0}.single-body th,.single-body td{padding:.75rem;text-align:left;border-bottom:1px solid var(--border-color)}.single-body th{background-color:var(--bg-secondary);font-weight:600}.single-body a{color:var(--primary-color);text-decoration:none;transition:var(--transition)}.single-body a:hover{color:var(--secondary-color);text-decoration:underline}.single-footer{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border-color)}.tags{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.tags h4{margin:0;color:var(--text-primary)}@media(max-width:768px){.single-title{font-size:2rem}.single-description{font-size:1.125rem}.single-meta{flex-direction:column;gap:1rem}.single-body h1{font-size:2rem}.single-body h2{font-size:1.5rem}.tags{flex-direction:column;align-items:flex-start}}</style></main><footer class=footer role=contentinfo><div class=container><div class=footer-content><div class=footer-info><h3>Billy Petersson</h3><p>Professional IT portfolio showcasing expertise in software development, system administration, and technology solutions</p></div><div class=footer-links><h4>Quick Links</h4><nav aria-label="Footer navigation"><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/skills/>Skills</a></li><li><a href=/experience/>Experience</a></li><li><a href=/projects/>Projects</a></li><li><a href=/blog/>Blog</a></li><li><a href=/contact/>Contact</a></li></ul></nav></div><div class=footer-social><h4>Connect</h4><div class=social-links role=list><a href=https://linkedin.com/in/billy-petersson target=_blank rel="noopener noreferrer" aria-label="LinkedIn Profile" role=listitem><i class="fab fa-linkedin" aria-hidden=true></i>
<span class=sr-only>LinkedIn</span>
</a><a href=https://github.com/billy-petersson target=_blank rel="noopener noreferrer" aria-label="GitHub Profile" role=listitem><i class="fab fa-github" aria-hidden=true></i>
<span class=sr-only>GitHub</span>
</a><a href=mailto:billy@peterssontech.net aria-label="Send Email" role=listitem><i class="fas fa-envelope" aria-hidden=true></i>
<span class=sr-only>Email</span></a></div></div></div><div class=footer-bottom><p>&copy; 2025 Billy Petersson. All rights reserved.</p></div></div></footer><script src=/js/main.js></script></body></html>